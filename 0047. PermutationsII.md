# [47. Permutations II](https://leetcode.com/problems/permutations-ii/)

Given a collection of numbers that might contain duplicates, return all possible unique permutations.

Example:

    Input: [1,1,2]
    Output:
    [
      [1,1,2],
      [1,2,1],
      [2,1,1]
    ]

-----

**题目**： 对给定的数组`nums`进行全排列，其中`nums`可能包含重复的元素。返回的全排列集合中应是无重复的解的（去重的）。

**思路**： 同[Permutations](https://blog.csdn.net/grllery/article/details/86540690)。记`p`为一个待填充的排列，当`p`的长度等于数组`nums`的长度时，表明已经找到了一种排列。针对`p`的同一个位置，为了不出现重复的排列，回溯返回后继续循环时需要跳过已经使用过的元素值。比如`p[1]`以值为`3`进行递归，当递归回溯到`p[1]`这个状态时，`p[1]`的下一个取值应该跳过值同样为`3`的元素（因此最开始需要对`nums`进行排序），然后再递归进入`p[2]`状态，依次类推。

[**工程代码下载**](https://github.com/abesft/leetcode/blob/master/047PermutationsII/047PermutationsII.cpp)

```cpp
#include <iostream>
#include<vector>
#include<algorithm>
using namespace std;

class Solution {
public:
    vector<vector<int>> permuteUnique(vector<int>& nums) {
        vector<vector<int>> res;
        if (nums.size() == 0)
            return res;

        sort(nums.begin(), nums.end());
        vector<bool> used(nums.size(), false);
        vector<int> p;
        backtracking(nums, res, p, used);

        return res;
    }

private:
    void backtracking(vector<int>& nums, vector<vector<int>>& res, vector<int>& p, vector<bool>& used) {
        if (p.size() == nums.size()) {
            res.push_back(p);
            return;
        }

        for (int i = 0; i < nums.size(); ) {
            //nums[i]已经加入到p中， 则跳过
            if (used[i]) {
                ++i;
                continue;
            }

            p.push_back(nums[i]);
            used[i] = true;
            backtracking(nums, res, p, used);
            p.pop_back();
            used[i] = false;

            //跳过重复的元素
            while (++i < nums.size() && nums[i] == nums[i - 1])
                continue;
        }
    }
};

int main()
{
    Solution sln;
    vector<int> testcase{ 1,1,2,2,2,2,2,2,2,2 };
    vector<vector<int>> res;
    res = sln.permuteUnique(testcase);
    for (auto vec : res) {
        for (auto i : vec)
            cout << i << " ";
        cout << endl;
    }
    std::cout << "Hello World!\n";
}
```